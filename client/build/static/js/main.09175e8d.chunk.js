(this["webpackJsonpmern-client"]=this["webpackJsonpmern-client"]||[]).push([[0],{60:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),c=a(47),s=a.n(c),i=(a(60),a(19)),l=a(10),o=a(2),j=r.a.createContext(),d=function(e){var t=Object(n.useState)({name:"John",gamertag:"Admin",xuid:142323,email:"",password:""}),a=Object(l.a)(t,2),r=a[0];a[1];return Object(o.jsx)(j.Provider,{value:{currentUser:r},children:e})},m=a(16),b=a(5),u=a(53),h=a(77),O=a(79),x=a(76),p=a(51),g=function(){return Object(o.jsx)("div",{className:"container",children:"HELLO WORLD"})};var f,w,v,N=function(e){var t=e.children;return Object(o.jsx)("div",{style:{height:560,clear:"both",paddingTop:120,textAlign:"center"},children:t})},y=function(){return Object(o.jsx)("div",{children:Object(o.jsxs)(N,{children:[Object(o.jsx)("h1",{children:"404 Page Not Found"}),Object(o.jsx)("h1",{children:Object(o.jsx)("span",{role:"img","aria-label":"Face With Rolling Eyes Emoji",children:"\ud83d\ude44"})})]})})},k=a(23),S=a(30),$=a(24),F=a.n($),C=a(80),L=a(35),E=a(78),I=Object(E.a)(f||(f=Object(L.a)(["\n    mutation login($email: String!, $password: String!) {\n        login(email: $email, password: $password) {\n            token\n            user {\n                _id\n            }\n        }\n    }\n"]))),T=(Object(E.a)(w||(w=Object(L.a)(["\n    mutation addOrder($products: [ID]!) {\n        addOrder(products: $products) {\n            purchaseDate\n            products {\n                _id\n                name\n                description\n                price\n                quantity\n                category {\n                    name\n                }\n            }\n        }\n    }\n"]))),Object(E.a)(v||(v=Object(L.a)(["\n    mutation Mutation($firstName: String!, $lastName: String!, $gamertag: String!, $email: String!, $password: String!) {\n        addUser(firstName: $firstName, lastName: $lastName, gamertag: $gamertag, email: $email, password: $password) {\n            token\n            user {\n                firstName\n                lastName\n                gamertag\n                email\n            }\n        }\n    }\n"])))),D=a(48),_=a(49),P=a(37),G=a.n(P),H=new(function(){function e(){Object(D.a)(this,e)}return Object(_.a)(e,[{key:"getProfile",value:function(){return G()(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return G()(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}());var J=function(e){var t=Object(n.useState)({email:"",password:""}),a=Object(l.a)(t,2),r=a[0],c=a[1],s=Object(C.a)(I),j=Object(l.a)(s,2),d=j[0],b=j[1].error,u=function(){var e=Object(S.a)(F.a.mark((function e(t){var a,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,d({variables:{email:r.email,password:r.password}});case 4:a=e.sent,n=a.data.login.token,H.login(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),h=function(e){var t=e.target,a=t.name,n=t.value;c(Object(i.a)(Object(i.a)({},r),{},Object(k.a)({},a,n)))};return Object(o.jsxs)("div",{className:"container my-1",children:[Object(o.jsx)(m.b,{to:"/signup",children:"\u2190 Go to Signup"}),Object(o.jsx)("h2",{children:"Login"}),Object(o.jsxs)("form",{onSubmit:u,children:[Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"email",children:"Email address:"}),Object(o.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:h})]}),Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(o.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:h})]}),b?Object(o.jsx)("div",{children:Object(o.jsx)("p",{className:"error-text",children:"The provided credentials are incorrect"})}):null,Object(o.jsx)("div",{className:"flex-row flex-end",children:Object(o.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var U=function(e){var t=Object(n.useState)({email:"",password:"",gamertag:""}),a=Object(l.a)(t,2),r=a[0],c=a[1],s=Object(C.a)(T),j=Object(l.a)(s,1)[0],d=function(){var e=Object(S.a)(F.a.mark((function e(t){var a,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,j({variables:{email:r.email,password:r.password,firstName:r.firstName,lastName:r.lastName,gamertag:r.gamertag}});case 3:a=e.sent,n=a.data.addUser.token,console.log(a),H.login(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(e){var t=e.target,a=t.name,n=t.value;c(Object(i.a)(Object(i.a)({},r),{},Object(k.a)({},a,n)))};return Object(o.jsxs)("div",{className:"container my-1",children:[Object(o.jsx)(m.b,{to:"/login",children:"\u2190 Go to Login"}),Object(o.jsx)("h2",{children:"Signup"}),Object(o.jsxs)("form",{onSubmit:d,children:[Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"firstName",children:"First Name:"}),Object(o.jsx)("input",{placeholder:"First",name:"firstName",type:"firstName",id:"firstName",onChange:b})]}),Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"lastName",children:"Last Name:"}),Object(o.jsx)("input",{placeholder:"Last",name:"lastName",type:"lastName",id:"lastName",onChange:b})]}),Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"gamertag",children:"Gamertag:"}),Object(o.jsx)("input",{placeholder:"tag",name:"gamertag",type:"gamertag",id:"gamertag",onChange:b})]}),Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(o.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:b})]}),Object(o.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(o.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(o.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:b})]}),Object(o.jsx)("div",{className:"flex-row flex-end",children:Object(o.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var q=function(){return Object(o.jsxs)("header",{className:"flex-row px-1",children:[Object(o.jsx)("h1",{children:Object(o.jsxs)(m.b,{to:"/",children:[Object(o.jsx)("span",{role:"img","aria-label":"shopping bag",children:"\ud83d\udecd\ufe0f"}),"-Shop-Shop"]})}),Object(o.jsx)("nav",{children:H.loggedIn()?Object(o.jsxs)("ul",{className:"flex-row",children:[Object(o.jsx)("li",{className:"mx-1",children:Object(o.jsx)(m.b,{to:"/orderHistory",children:"Order History"})}),Object(o.jsx)("li",{className:"mx-1",children:Object(o.jsx)("a",{href:"/",onClick:function(){return H.logout()},children:"Logout"})})]}):Object(o.jsxs)("ul",{className:"flex-row",children:[Object(o.jsx)("li",{className:"mx-1",children:Object(o.jsx)(m.b,{to:"/signup",children:"Signup"})}),Object(o.jsx)("li",{className:"mx-1",children:Object(o.jsx)(m.b,{to:"/login",children:"Login"})})]})})]})},A=Object(u.a)({uri:"/graphql"}),B=Object(p.a)((function(e,t){var a=t.headers,n=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},a),{},{authorization:n?"Bearer ".concat(n):""})}})),M=new h.a({link:B.concat(A),cache:new O.a});var R=function(){return Object(o.jsx)(x.a,{client:M,children:Object(o.jsx)(m.a,{children:Object(o.jsx)("div",{children:Object(o.jsxs)(d,{children:[Object(o.jsx)(q,{}),Object(o.jsxs)(b.c,{children:[Object(o.jsx)(b.a,{path:"/",element:Object(o.jsx)(g,{})}),Object(o.jsx)(b.a,{path:"/login",element:Object(o.jsx)(J,{})}),Object(o.jsx)(b.a,{path:"/signup",element:Object(o.jsx)(U,{})}),Object(o.jsx)(b.a,{path:"*",element:Object(o.jsx)(y,{})})]})]})})})})};s.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(R,{})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.09175e8d.chunk.js.map